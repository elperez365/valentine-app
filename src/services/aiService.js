// Servizio Template - Messaggi statici per i risultati
// Tantissimi template per varietÃ  massima!

const loveLetterTemplates = {
  perfect: [
    "Carissimi {p1} e {p2}, siete davvero anime gemelle! ðŸ’• La vostra connessione Ã¨ qualcosa di raro e prezioso. Continuate a coltivare questo amore straordinario che vi unisce.",
    "{p1} e {p2}, la vostra sintonia Ã¨ magica! âœ¨ Pensate allo stesso modo, sognate le stesse cose. Siete la prova che l'amore vero esiste.",
    "Wow, {p1} e {p2}! ðŸ’˜ Una compatibilitÃ  perfetta Ã¨ rara come un diamante. Custodite questo tesoro che avete trovato l'uno nell'altra.",
    "{p1} e {p2}, siete fatti l'uno per l'altra! ðŸŒŸ La vostra intesa Ã¨ cosÃ¬ profonda che sembra magia. L'universo vi ha destinati a stare insieme.",
    "Incredibile, {p1} e {p2}! ðŸ’« Avete raggiunto la perfezione. Due cuori che battono all'unisono, due menti che pensano come una sola.",
    "{p1} e {p2}, questa Ã¨ poesia pura! ðŸŒ¹ La vostra compatibilitÃ  al 100% Ã¨ un dono raro. Siete l'esempio vivente che le fiabe esistono.",
    "Meraviglioso! {p1} e {p2}, siete come due pezzi dello stesso puzzle. ðŸ§© Perfettamente incastrati, inseparabili per sempre.",
    "{p1} e {p2}, il destino vi ha uniti! â­ Non esistono coincidenze quando due anime si trovano cosÃ¬ perfettamente.",
    "Che spettacolo, {p1} e {p2}! ðŸŽ† La vostra sintonia Ã¨ da record. Avete trovato la vostra persona, quella giusta al 100%.",
    "{p1} e {p2}, siete la definizione di coppia perfetta! ðŸ’– Ogni risposta uguale racconta di un legame profondo e autentico.",
    "Stupefacente! {p1} e {p2}, la vostra connessione sfida ogni statistica. ðŸ† Siete fatti per stare insieme.",
    "{p1} e {p2}, avete trovato il vero amore! ðŸ’ž Quando due persone sono cosÃ¬ in sintonia, nulla puÃ² separarle.",
    "Fantastico, {p1} e {p2}! ðŸŒº La vostra compatibilitÃ  perfetta Ã¨ un miracolo dell'amore. Tenetevi stretti.",
    "{p1} e {p2}, siete come le stelle gemelle! â­â­ Brillate insieme, illuminate insieme, amate insieme.",
    "Eccezionale! {p1} e {p2}, avete dimostrato che l'amore perfetto esiste. ðŸ’ Siete un esempio per tutti.",
  ],
  high: [
    "{p1} e {p2}, avete una bellissima intesa! ðŸ’‘ Le piccole differenze sono il sale della vita - vi aiuteranno a crescere insieme.",
    "Che bella coppia siete, {p1} e {p2}! ðŸŒ¹ La vostra connessione Ã¨ forte e autentica. Continuate a scoprirvi giorno dopo giorno.",
    "{p1} e {p2}, siete sulla strada giusta! ðŸ’ L'amore che condividete Ã¨ evidente. Le vostre somiglianze vi uniscono, le differenze vi completano.",
    "Splendida coppia! {p1} e {p2}, la vostra compatibilitÃ  racconta di un legame speciale. ðŸ’« Avete trovato qualcuno che vi capisce davvero.",
    "{p1} e {p2}, il vostro amore brilla! âœ¨ Una compatibilitÃ  cosÃ¬ alta parla di un legame destinato a durare.",
    "Complimenti {p1} e {p2}! ðŸŽŠ Siete una coppia solida con una base fortissima. Le piccole differenze vi rendono interessanti.",
    "{p1} e {p2}, avete qualcosa di speciale! ðŸ’• La vostra intesa Ã¨ evidente in ogni risposta. Continuate cosÃ¬!",
    "Bellissimo risultato, {p1} e {p2}! ðŸŒ¸ La vostra compatibilitÃ  dimostra quanto vi conoscete e vi amate.",
    "{p1} e {p2}, siete una squadra vincente! ðŸ… Insieme potete affrontare qualsiasi sfida.",
    "Che sintonia, {p1} e {p2}! ðŸ’— Il vostro legame Ã¨ forte e promette un futuro luminoso insieme.",
    "{p1} e {p2}, l'amore tra voi Ã¨ palpabile! ðŸ’“ Avete costruito qualcosa di bello e autentico.",
    "Fantastico, {p1} e {p2}! ðŸŒŸ La vostra compatibilitÃ  alta Ã¨ il frutto di un amore vero e profondo.",
    "{p1} e {p2}, siete fatti per camminare insieme! ðŸ‘« Le vostre strade si sono incrociate per un motivo.",
    "Ottimo risultato! {p1} e {p2}, la vostra relazione ha basi solidissime. ðŸ  Continuate a costruire insieme.",
    "{p1} e {p2}, il vostro amore Ã¨ una melodia armoniosa! ðŸŽµ Qualche nota diversa rende la musica ancora piÃ¹ bella.",
    "Bravissimi {p1} e {p2}! ðŸ‘ La vostra intesa dimostra quanto tenete l'uno all'altra.",
    "{p1} e {p2}, siete come il sole e la luna! â˜€ï¸ðŸŒ™ Diversi ma complementari, insieme illuminate il cielo.",
    "Che coppia meravigliosa, {p1} e {p2}! ðŸŒ· Il vostro amore Ã¨ forte e le differenze lo rendono piÃ¹ interessante.",
    "{p1} e {p2}, avete trovato il vostro equilibrio! âš–ï¸ Una coppia cosÃ¬ affiatata Ã¨ rara e preziosa.",
    "Stupendo! {p1} e {p2}, la vostra storia d'amore sta scrivendo pagine bellissime. ðŸ“–",
  ],
  medium: [
    "{p1} e {p2}, il vostro amore Ã¨ un'avventura! ðŸŒŸ Avete tanto da scoprire l'uno dell'altra - ogni differenza Ã¨ un'opportunitÃ  di crescita.",
    "Carissimi {p1} e {p2}, la diversitÃ  arricchisce! ðŸ’« Dove non siete allineati, potete imparare l'uno dall'altra.",
    "{p1} e {p2}, ogni coppia ha il suo percorso unico! ðŸ’• Le vostre differenze sono occasioni per dialogare e comprendervi meglio.",
    "{p1} e {p2}, l'amore si costruisce giorno dopo giorno! ðŸŒˆ Le vostre differenze rendono la relazione piÃ¹ interessante e stimolante.",
    "{p1} e {p2}, siete un mix perfetto di somiglianze e differenze! ðŸŽ¨ Questa Ã¨ la ricetta per una relazione equilibrata.",
    "Interessante, {p1} e {p2}! ðŸ”® Le vostre differenze sono opportunitÃ  per crescere insieme e imparare nuove prospettive.",
    "{p1} e {p2}, avete una base solida! ðŸ—ï¸ Con un po' di lavoro sulle differenze, potete costruire qualcosa di straordinario.",
    "Bene cosÃ¬, {p1} e {p2}! ðŸ’ª La vostra relazione ha il potenziale per diventare ancora piÃ¹ forte.",
    "{p1} e {p2}, le differenze rendono tutto piÃ¹ interessante! ðŸŒº Non sarebbe noioso essere sempre d'accordo?",
    "Coraggio, {p1} e {p2}! ðŸ¦‹ Ogni differenza Ã¨ un ponte da costruire, un'occasione per avvicinarvi ancora di piÃ¹.",
    "{p1} e {p2}, siete sulla buona strada! ðŸ›¤ï¸ Il vostro amore puÃ² solo crescere se continuate a comunicare.",
    "Non male, {p1} e {p2}! ðŸŒ» Le coppie piÃ¹ forti sono quelle che sanno gestire le differenze con rispetto.",
    "{p1} e {p2}, avete margine di crescita! ðŸ“ˆ E questo Ã¨ entusiasmante - potete migliorare insieme.",
    "Interessante risultato, {p1} e {p2}! ðŸ§­ Le vostre differenze sono la bussola per esplorare nuovi territori insieme.",
    "{p1} e {p2}, il bello dell'amore Ã¨ scoprirsi! ðŸ” Avete ancora tanto da imparare l'uno dell'altra.",
    "Buon punto di partenza, {p1} e {p2}! ðŸš€ Con impegno reciproco, potete raggiungere le stelle.",
    "{p1} e {p2}, la vostra relazione Ã¨ un giardino! ðŸŒ± Con cura e pazienza, fioriranno i frutti piÃ¹ belli.",
    "Promettente, {p1} e {p2}! ðŸ’ Le differenze sono spezie che rendono l'amore piÃ¹ saporito.",
    "{p1} e {p2}, siete un'opera in progress! ðŸ–¼ï¸ E le opere piÃ¹ belle richiedono tempo e dedizione.",
    "Avanti cosÃ¬, {p1} e {p2}! ðŸƒ Ogni passo insieme vi avvicina a una sintonia ancora maggiore.",
  ],
  low: [
    "{p1} e {p2}, gli opposti si attraggono! ðŸ”¥ Le vostre differenze possono diventare la vostra forza se imparate ad ascoltarvi.",
    "{p1} e {p2}, avete una sfida davanti a voi! ðŸ’ª Ma con comunicazione e pazienza, potete costruire qualcosa di speciale.",
    "Cari {p1} e {p2}, la compatibilitÃ  si costruisce! ðŸŒ± Parlate apertamente delle vostre differenze - Ã¨ il primo passo verso una connessione piÃ¹ profonda.",
    "{p1} e {p2}, le differenze non sono ostacoli ma opportunitÃ ! ðŸŒ» Ogni coppia deve lavorare sulla propria sintonia, e voi avete tanto potenziale.",
    "{p1} e {p2}, non scoraggiatevi! ðŸŒˆ Le coppie piÃ¹ solide sono quelle che hanno superato le sfide insieme.",
    "Ehi {p1} e {p2}, la diversitÃ  Ã¨ ricchezza! ðŸ’Ž Dovete solo imparare a valorizzarla.",
    "{p1} e {p2}, vedete il bicchiere mezzo pieno! ðŸ¥‚ Avete l'opportunitÃ  di scoprire mondi nuovi l'uno nell'altra.",
    "Interessante, {p1} e {p2}! ðŸŽ­ Siete cosÃ¬ diversi che non vi annoierete mai insieme.",
    "{p1} e {p2}, la sfida Ã¨ parte del viaggio! ðŸ§— Le montagne piÃ¹ alte offrono le viste piÃ¹ belle.",
    "Non temete, {p1} e {p2}! ðŸŒŸ L'amore vero si costruisce anche attraverso le differenze.",
    "{p1} e {p2}, siete come il fuoco e l'acqua! ðŸ”¥ðŸ’§ Insieme potete creare equilibrio o vapore esplosivo - sta a voi scegliere.",
    "Coraggio {p1} e {p2}! ðŸ¦ Le coppie che lavorano sulle differenze diventano le piÃ¹ forti.",
    "{p1} e {p2}, ogni grande storia d'amore ha i suoi ostacoli! ðŸ“š Superate insieme questa fase e sarete invincibili.",
    "Non arrendetevi {p1} e {p2}! ðŸ‹ï¸ L'amore Ã¨ una maratona, non uno sprint. Allenatevi insieme.",
    "{p1} e {p2}, le differenze sono maestri! ðŸ“– Vi insegneranno la pazienza, l'ascolto e il compromesso.",
    "Pensate positivo, {p1} e {p2}! â˜€ï¸ Le nuvole di oggi possono diventare l'arcobaleno di domani.",
    "{p1} e {p2}, siete pionieri! ðŸš€ State esplorando territori sconosciuti dell'amore insieme.",
    "Niente panico, {p1} e {p2}! ðŸ§˜ Con calma e dialogo, ogni differenza puÃ² trasformarsi in forza.",
    "{p1} e {p2}, l'amore vero supera tutto! ðŸ’– Se ci tenete davvero, troverete la vostra strada.",
    "Forza {p1} e {p2}! ðŸ’« Le coppie che partono da qui hanno il potenziale di stupire tutti.",
  ],
};

const adviceTemplates = [
  "ðŸ’¬ Dedicate del tempo ogni settimana per parlare apertamente dei vostri desideri e aspettative.",
  "ðŸ‘Ÿ Provate a mettervi nei panni dell'altro quando avete opinioni diverse - l'empatia Ã¨ la chiave.",
  "ðŸŽ¨ Celebrate le vostre differenze! Sono ciÃ² che rende la vostra relazione unica e interessante.",
  "âœ¨ Create dei rituali di coppia che vi appartengano solo a voi due.",
  "ðŸ¤ Ricordate che non dovete essere d'accordo su tutto - il rispetto Ã¨ piÃ¹ importante della conformitÃ .",
  "ðŸŽ¯ Fate delle attivitÃ  nuove insieme per scoprire interessi comuni che non sapevate di avere.",
  "ðŸ‘‚ Quando discutete, ascoltate per capire, non per rispondere.",
  "ðŸ’ Sorprendetevi a vicenda con piccoli gesti d'affetto quotidiani.",
  "ðŸ—“ï¸ Pianificate regolarmente momenti speciali solo per voi due.",
  "ðŸ˜Š Non dimenticate mai di ridere insieme - l'umorismo Ã¨ un collante potente.",
  "ðŸŒŸ Esprimete gratitudine per le piccole cose che fate l'uno per l'altra.",
  "ðŸ  Create uno spazio sicuro dove potete essere vulnerabili senza giudizio.",
  "ðŸ“± Mettete via i telefoni quando siete insieme - la presenza Ã¨ il regalo piÃ¹ grande.",
  "ðŸ³ Cucinate insieme almeno una volta a settimana - Ã¨ un'attivitÃ  che unisce.",
  "ðŸš¶ Fate passeggiate serali per parlare della giornata senza distrazioni.",
  "ðŸ“ Scrivete una lista delle cose che amate dell'altro e condividetela.",
  "ðŸŽ Non aspettate le occasioni speciali per fare un regalo - le sorprese quotidiane valgono di piÃ¹.",
  "ðŸ§˜ Praticate la pazienza - l'altro non puÃ² leggervi nel pensiero.",
  "ðŸ’ª Supportatevi a vicenda nei momenti difficili senza giudicare.",
  "ðŸŒ™ Non andate mai a dormire arrabbiati - risolvete prima i conflitti.",
  "ðŸŽµ Create una playlist delle 'vostre' canzoni e ascoltatela insieme.",
  "ðŸ“¸ Fotografate i momenti felici - vi aiuterÃ  nei momenti difficili.",
  "ðŸ–ï¸ Pianificate insieme le vacanze - sognare insieme rafforza il legame.",
  "ðŸ¤— Abbracciatevi almeno 8 volte al giorno - la scienza dice che fa bene!",
  "ðŸ’­ Chiedetevi sempre 'Come posso rendere felice il mio partner oggi?'",
  "ðŸŽ­ Accettate che l'altro cambi nel tempo - crescere insieme Ã¨ bello.",
  "ðŸ”‘ Date all'altro lo spazio di cui ha bisogno - la fiducia Ã¨ fondamentale.",
  "ðŸŒˆ Festeggiate i piccoli traguardi insieme, non solo i grandi.",
  "ðŸ’‘ Fate un 'appuntamento' settimanale come se foste ancora fidanzati.",
  "ðŸŽª Provate cose nuove insieme - uscite dalla comfort zone!",
  "ðŸ“– Leggete lo stesso libro e discutetene insieme.",
  "ðŸ§© Imparate a fare compromessi senza tener conto dei punti.",
  "â¤ï¸ Dite 'ti amo' ogni giorno, ma dimostratelo con i fatti.",
  "ðŸŒ» Sostenete i sogni dell'altro anche quando sembrano impossibili.",
  "ðŸŽˆ Non prendete tutto troppo sul serio - ridete delle piccole cose.",
];

const compatibleAdviceTemplates = [
  "ðŸŽ‰ Continuate a coltivare questa sintonia speciale che avete!",
  "ðŸš€ Non date per scontata la vostra compatibilitÃ  - continuate a investire nella relazione.",
  "ðŸ’« Esplorate nuovi orizzonti insieme - avete le basi per grandi avventure!",
  "ðŸŒˆ La vostra intesa Ã¨ rara - festeggiatela ogni giorno con piccoli gesti.",
  "â¤ï¸ Siete fortunati ad avervi trovati - non smettete mai di sorprendervi a vicenda.",
  "ðŸŒŸ Mantenete viva la curiositÃ  reciproca - c'Ã¨ sempre qualcosa di nuovo da scoprire.",
  "ðŸ’• La vostra sintonia Ã¨ un dono - proteggetela con cura e attenzione quotidiana.",
  "ðŸŽŠ Siete un esempio per gli altri - condividete il segreto del vostro amore!",
  "âœ¨ Non smettete mai di corteggiarvi - anche dopo anni insieme.",
  "ðŸ† Avete vinto alla lotteria dell'amore - godetevi ogni momento insieme.",
  "ðŸ’– La vostra connessione Ã¨ speciale - alimentatela con nuove esperienze.",
  "ðŸŒº Siete una coppia da sogno - continuate a sognare insieme!",
  "ðŸŽ Ogni giorno Ã¨ un regalo quando si Ã¨ cosÃ¬ in sintonia - apprezzatelo.",
  "ðŸ’ž La vostra compatibilitÃ  Ã¨ la base - costruiteci sopra ricordi indimenticabili.",
  "ðŸŒ  Insieme potete raggiungere le stelle - non ponete limiti ai vostri sogni.",
];

// Funzione per mescolare array (Fisher-Yates shuffle)
const shuffleArray = (arr) => {
  const shuffled = [...arr];
  for (let i = shuffled.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  return shuffled;
};

// Usa timestamp + random per maggiore varietÃ 
const getRandomIndex = (arrayLength) => {
  const timeComponent = Date.now() % 1000;
  const randomComponent = Math.random() * 1000;
  return Math.floor((timeComponent + randomComponent) % arrayLength);
};

const pickRandom = (arr) => arr[getRandomIndex(arr.length)];

// Cache per evitare rigenerazione nella stessa sessione
let cachedResult = null;

export const resetCache = () => {
  cachedResult = null;
};

export const getCachedResult = () => cachedResult;

// Genera contenuto con template
export const generateLoveContent = (
  player1Name,
  player2Name,
  score,
  matchingAnswers,
  differentAnswers
) => {
  // Se abbiamo giÃ  il risultato, restituiscilo
  if (cachedResult) {
    return cachedResult;
  }

  // Scegli categoria in base al punteggio
  let category;
  if (score === 100) category = "perfect";
  else if (score >= 70) category = "high";
  else if (score >= 40) category = "medium";
  else category = "low";

  // Genera lettera d'amore - mescola prima per maggiore varietÃ 
  const shuffledLetters = shuffleArray(loveLetterTemplates[category]);
  const letterTemplate = shuffledLetters[0];
  const loveLetter = letterTemplate
    .replace(/{p1}/g, player1Name)
    .replace(/{p2}/g, player2Name);

  // Genera consigli
  let advice = "";
  if (differentAnswers && differentAnswers.length > 0) {
    // Se ci sono differenze, dai consigli specifici
    // Mescola e prendi i primi 2
    const shuffledAdvice = shuffleArray(adviceTemplates);
    advice = shuffledAdvice.slice(0, 2).join("\n\n");
  } else {
    // Se sono molto compatibili, dai consigli per mantenere la relazione
    const shuffledCompatible = shuffleArray(compatibleAdviceTemplates);
    advice = shuffledCompatible[0];
  }

  cachedResult = { loveLetter, advice };
  return cachedResult;
};

// Funzioni vuote per compatibilitÃ  (non fanno nulla)
export const startModelDownload = () => {};
export const preGenerateContent = () => {};
export const cancelGeneration = () => {};
export const isModelReadyStatus = () => true;
export const isCurrentlyGenerating = () => false;
export const getLoadingProgress = () => 100;
